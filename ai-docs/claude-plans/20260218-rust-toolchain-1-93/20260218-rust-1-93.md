# Plan: Fix Rust 1.87→1.93 Upgrade Warnings and Test Failures

## Context

Upgrading Rust from 1.87.0 to 1.93.0 introduced new compiler warnings and a trybuild test failure. Rust 1.93 has improved diagnostic messages for trait bound errors (changing format from "the trait `X` is not implemented for `Y`" to "unsatisfied trait bound" with a help pointing at the struct definition). It also enforces the `mismatched_lifetime_syntaxes` lint (introduced in 1.89) and is stricter about `dead_code` warnings in test code.

## Issues and Fixes

### 1. Trybuild test failure: `invalid_error_type.stderr` (BLOCKING)

**File:** `crates/errmeta_derive/tests/fails/invalid_error_type.stderr`

The Rust 1.93 compiler changed the error message format for E0277. The `.stderr` file contains the old format and needs updating to match the new compiler output.

**Fix:** Run `TRYBUILD=overwrite cargo test -p errmeta_derive --test trybuild` to regenerate the `.stderr` file with the new compiler output format. Then review the diff to confirm it's just a message format change.

### 2. Warning: `dead_code` for `TestArgsDelegateFalse` enum

**File:** `crates/errmeta_derive/tests/test_args_delegate.rs:38`

The enum `TestArgsDelegateFalse` is defined with `#[derive(Debug, thiserror::Error, ErrorMeta)]` but is never constructed or used in any test case. It only exists as a type definition. Rust 1.93 now warns about this.

**Fix:** Add `#[allow(dead_code)]` on the enum, since it exists to test that the derive macro compiles correctly (its purpose is compile-time validation, not runtime use).

### 3. Warning: `dead_code` for `TestConfig` struct

**File:** `crates/services/src/setting_service/tests.rs:23`

The struct `TestConfig` is defined but never constructed anywhere in the test file. It appears to be leftover/unused test infrastructure.

**Fix:** Remove the `TestConfig` struct entirely (lines 22-26), since it's unused dead code.

### 4. Warning: `mismatched_lifetime_syntaxes` for `create_session_cookie`

**File:** `crates/server_app/tests/utils/live_server_utils.rs:370`

The function signature `fn create_session_cookie(session_id: &str) -> Cookie` has an elided lifetime on input (`&str`) but a hidden lifetime on output (`Cookie` which is actually `Cookie<'_>`). Rust 1.89+ warns about this inconsistency.

**Fix:** Change return type to `Cookie<'_>`:
```rust
pub fn create_session_cookie(session_id: &str) -> Cookie<'_> {
```

## Verification

1. `TRYBUILD=overwrite cargo test -p errmeta_derive --test trybuild` — regenerate stderr, then verify test passes
2. `cargo test -p errmeta_derive` — all tests pass, no warnings
3. `cargo test -p services` — no `TestConfig` warning
4. `cargo build --tests 2>&1 | grep warning` — verify no remaining warnings from our code
